<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"> <title>RRT</title>
</head>

<body style="font-family:sans-serif; font-size:15px; width:600px; margin-left:auto; margin-right:auto; ">



<div id="draw" style="width: 700px;height: 600px; display:inline-block">
 <!--<img src="NewtonDrawing.jpg" width="500" height="500">-->

<svg id="theSVG" style="border:1px solid black; background-color:#e0e0e0;width: 600px;height: 600px;">
</svg>


<div style="vertical-align: top; display: inline-block"><button onclick="run()" style="height: 20px; width: 50px;">Run</button></div>
<!--</canvas>-->

</div>


<script src = ./jquery-2.2.3.js></script>
<script src=./index.js></script>

<script src=./helperFunctions.js></script>
<script src="PRMStar.js"></script>
<script src="K-RRG.js"></script>
<script src="RRT.js"></script>
<script src="graphlib.js"></script>
<script>



var obstacles= [];
    $(function () {
    var drawingState = "none";
    var circumX, circumY;
    var currentObstacle = 1;
    $("#theSVG").click(function (e) {
        if (drawingState == "none") {
            $('#theSVG').html($('#theSVG').html()+'<line  x1='+e.offsetX+' y1='+e.offsetY+'  id="dashedLine-'+currentObstacle+'" stroke-dasharray="5" stroke="black"  fill="red"></line>');
            $('#dashedLine-'+currentObstacle).hide();
            drawingState = "drawing";
            circumX = e.offsetX;
            circumY = e.offsetY;
        } else if (drawingState == "drawing") {
            var radius = Math.round(Math.sqrt(Math.pow(circumX-e.offsetX, 2) + Math.pow(circumY-e.offsetY, 2)));
            $('#theSVG').html('<circle id="circle-'+currentObstacle+'" r="4" stroke="black"  fill="red"></circle>'+$('#theSVG').html());
            $('#circle-'+currentObstacle).attr("cx",e.offsetX);
            $('#circle-'+currentObstacle).attr("cy",e.offsetY);
            $('#circle-'+currentObstacle).attr("r",radius);
            obstacles.push(e.offsetX);
            obstacles.push(e.offsetY);
            obstacles.push(radius);
            currentObstacle++;
            drawingState="none";
        }
    });
        $("#theSVG").mousemove(function (e) {
//            console.log(e.offsetX+ " "+e.offsetY);
            $('#dashedLine-'+currentObstacle).attr("x2",e.offsetX);
            $('#dashedLine-'+currentObstacle).attr("y2",e.offsetY);
            $('#dashedLine-'+currentObstacle).show();
        });

    });
function run() {


    //var result = k_RRG(obstacles,200,new Vertex(300,300,"300300"),0,600,0,600);
    var obs = [];
    obs.push(119);
    obs.push(38);
    obs.push(42);
    var source = new Vertex(78, 73, "105359");

    var dest = new Vertex(154, 63, "142310");

    var linkResult = link(obs, source, dest);
console.log(linkResult);

    var start = [];
    start.push(50);
    start.push(50);
    var dest = [];
    var result = prm(obstacles, start,dest,50,10,0,600,0,600);
    //var result = rrt(obstacles, start,dest,50,0,600,0,600);

    var vertices = [];
    var adjList = new AdjList();
    var graph = new graphlib.Graph();
    var v1 = new Vertex(20,20,"2020");
    var v2 = new Vertex(40,40,"4040");
    var v3 = new Vertex(30,60,"3060");
    graph.setNode(v1.getId(),v1);
    graph.setNode(v2.getId(),v2);
    graph.setNode(v3.getId(),v3);
    graph.setEdge(v1.getId(),v2.getId(),5);
    graph.setEdge(v1.getId(),v3.getId(),15);
    graph.setEdge(v2.getId(),v3.getId(),25);


    graph.nodes().forEach(function(nodeLabel, idx, array) {
        vertex = graph.node(nodeLabel);
        $('#theSVG').html($('#theSVG').html()+'<circle id="vertex-'+idx+'" cx="'+vertex.getX()+'"  cy="'+vertex.getY()+'" r="4" stroke="black"  fill="blue"></circle>');

    });
    graph.edges().forEach(function(edge, idx, array) {
        var weight = graph.edge(edge);
        var source = graph.node(edge.v);
        var dest = graph.node(edge.w);
        var x1 = source.getX();
        var y1 = source.getY();
        var x2 = dest.getX();
        var y2 = dest.getY();
         $('#theSVG').html($('#theSVG').html()+'<line  x1='+x1+' y1='+y1+' x2='+x2+' y2='+y2+' id="edge-'+idx+'"  stroke="black"  fill="red"></line>');

    });

    function weight(e) { return graph.edge(e); }
    var result = graphlib.alg.dijkstra(graph, v1.getId(), weight);
    console.log(result);

}
</script>


</body>

</html>